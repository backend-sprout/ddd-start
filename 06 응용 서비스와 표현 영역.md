응용 서비스와 표현 영역
========================
`도메인`과 `리포지토리`를 통해 도메인을 구현하는 방법에 대해서 배웠다.  
그러나, **도메인이 제 기능을 하려면 사용자와 도메인을 연결해주는 매개체가 필요하다.**      
그리고 이러한 매개체들이 바로 **응용 서비스**와 **표현 영역**이다.      

**표현 영역**  
* 사용자의 요청을 해석한다.    
* 사용자가 어떤 기능을 실행하고 싶어하는지 판별하고 그 기능을 제공하는 응용서비스를 실행한다.   
    
**응용 서비스**        
* 사용자의 요청을 위한 기능을 제공하는 주체다.         
* 기능을 실행하는데 필요한 입력값을 메서드 파라미터로 전달 받고 실행 결과를 리턴한다.     
    
```java
@RequestMapping("/member/join")
public ModelAndView join(HttpServletRequest request) {
    String email = request.getParameter("email");
    String password = request.getParameter("password");
    // 사용자 요청을 응용 서비스에 맞게 변환 
    JoinRequest joinReq = new JoinRequest(email, password);
    // 응용 서비스의 메서드를 호출   
    joinService.join(joinReq);
    ...
}
```

사용자가 원하는 서비스마다의 데이터 형식이 일치하지 않기 때문에        
**표현 영역이 응용 서비스가 요구하는 객체를 생성한 뒤 응용 서비스의 메서드를 호출한다.**         
이후, 응용 서비스로부터 얻은 실행 결과를 사용자에 알맞은 형식으로 응답한다.       

사용자와의 상호작용은 표현 영역이 처리하기에 응용 서비스는 표현 영역에 의존하지 않는다.     
즉, 사용자가 어떠한 방식으로 접근했던지 응용 서비스는 핵심 기능 구현만 신경쓰면 된다.     

# 응용 서비스의 역할 
> 응용 서비스는 사용자가 요청한 기능을 실행한다.    

응용 서비스의 주요 역할은 **도메인 객체를 사용해서 사용자의 요청을 처리하는 것이다.**       
이로인해 표현 영역 입장에서는 **표현 영역과 도메인 영역을 연결해주는 창구 같은 역할이다.**      
        
**응용 서비스는 아래와 같은 작업을 수행한다.**        
* 리포지토리로부터 도메인 객체를 구한다.          
* 도메인 객체를 사용한다.(메서드 호출, 조합등)            

응용 서비스는 주로 도메인 객체 간의 흐름을 제어하기에 아래와 같은 단순한 형태를 갖는다.   
  
```java
public Result doSomeFunc(SomeReq req) {
    SomeAgg agg = someAggRepository.findById(req.getId());
    checkNull(agg);
    agg.doFunc(req.getValue());    
    return createSuccessResult(agg);
}
```
1. 리포지토리에서 애그리거트를 구한다.  
2. 애그리거트의 도메인 기능을 실행한다.    
3. 결과를 리턴한다.   

```java
public Result doSomeCreate(CreateSomeReq req) {
    checkValud(req);
    SomeAgg newAgg = createSome(req);
    somAggRepository.save(newAgg);
    return createSuccessResult(newAgg);
}
```
1. 데이터 중복 등 데이터가 유효한지 검사한다.   
2. 애그리거트를 생성한다.   
3. 리포지토리에 애그리거트를 저장한다.   
4. 결과를 리턴한다.  
  
만약 위와 같은 형태보다 복잡하다면     
**응용 서비스가 도메인 로직을 수행하고 있을 가능성이 높다.(때에 따라 다르지만 안 좋다.)**      
     
응용 서비스는 `도메인 객체 간의 흐름을 제어`외에도         
**도메인의 상태 변경을 트랜잭션으로 처리하는 역할**을 가지고 있다.       











